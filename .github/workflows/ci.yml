name: CI - Instagram Bot

on:
  push:
    branches: [ main ]
  pull_request:
    branches: [ main ]

jobs:
  syntax-check:
    name: Python Syntax Check
    runs-on: ubuntu-latest
    
    steps:
    - name: Checkout code
      uses: actions/checkout@v4
      
    - name: Set up Python 3.10
      uses: actions/setup-python@v4
      with:
        python-version: '3.10'
        
    - name: Install dependencies
      run: |
        python -m pip install --upgrade pip
        pip install -r requirements.txt
        
    - name: Check Python syntax
      run: |
        echo "üîç Checking Python syntax..."
        python -m py_compile get_followers.py
        python -m py_compile send_direct.py
        python -m py_compile report.py
        python -m py_compile config.py
        echo "‚úÖ All Python files compiled successfully!"
        
    - name: Validate requirements.txt
      run: |
        echo "üìã Checking requirements.txt..."
        pip install -r requirements.txt
        echo "‚úÖ requirements.txt is valid!"

  file-check:
    name: Project Structure Validation
    runs-on: ubuntu-latest
    
    steps:
    - name: Checkout code
      uses: actions/checkout@v4
      
    - name: Check required files exist
      run: |
        echo "üìÑ Checking project structure..."
        required_files=("get_followers.py" "send_direct.py" "report.py" "config.py" "README.md" "requirements.txt" "LICENSE" ".gitignore")
        for file in "${required_files[@]}"; do
          if [ -f "$file" ]; then
            echo "‚úÖ $file"
          else
            echo "‚ùå $file - MISSING"
            exit 1
          fi
        done
        echo "üéâ All required files are present!"

  docs-check:
    name: Documentation Check
    runs-on: ubuntu-latest
    if: github.event_name == 'push'
    
    steps:
    - name: Checkout code
      uses: actions/checkout@v4
      
    - name: Check GitHub Pages files
      run: |
        echo "üìñ Checking documentation..."
        if [ -f "docs/index.md" ]; then
          echo "‚úÖ docs/index.md exists"
        else
          echo "‚ö†Ô∏è  docs/index.md not found (GitHub Pages)"
        fi
